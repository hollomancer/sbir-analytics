# neo4j.conf - SBIR ETL runtime template
#
# This file is a template for Neo4j runtime configuration used by the SBIR ETL
# docker compose overrides. It is intentionally conservative and documents
# common knobs you may want to tune for local development, CI, and production.
#
# DO NOT commit production secrets into this file. Prefer environment variables
# (in .env or secret mounts) for sensitive values.
#
# To use:
#  - Place this file at config/neo4j/neo4j.conf in the repository
#  - Mount into the container at /var/lib/neo4j/conf/neo4j.conf (see docker/neo4j.compose.override.yml)
#  - Tune memory settings and TLS / plugin options as required
#
########################
# Memory Configuration #
########################
# JVM heap size (initial and max)
# Recommended: set according to available host memory. For local dev 512M is reasonable.
server.memory.heap.initial_size=${NEO4J_server_memory_heap_initial__size:-512m}
server.memory.heap.max_size=${NEO4J_server_memory_heap_max__size:-512m}

# Page cache size used for storing the Neo4j store files in memory
server.memory.pagecache.size=${NEO4J_server_memory_pagecache_size:-256M}

########################
# Connector / Networking
########################
# Listen on all interfaces by default (container environment)
dbms.default_listen_address=0.0.0.0

# Bolt connector (binary protocol)
dbms.connector.bolt.enabled=true
dbms.connector.bolt.tls_level=OPTIONAL
dbms.connector.bolt.listen_address=0.0.0.0:7687

# HTTP connector (legacy HTTP)
dbms.connector.http.enabled=true
dbms.connector.http.listen_address=0.0.0.0:7474

# HTTPS connector (if you enable TLS for HTTP)
dbms.connector.https.enabled=false
dbms.connector.https.listen_address=0.0.0.0:7473

########################
# Security & Authentication
########################
# Enable or disable auth. For local development you may disable it, but for CI/prod keep it enabled.
dbms.security.auth_enabled=true

# List of procedures allowed without explicit security restrictions.
# Add apoc.* and gds.* if using APOC/GDS procedures.
dbms.security.procedures.unrestricted=apoc.*,gds.*

# Procedures allowed to run from unmanaged extensions (if required)
# dbms.security.procedures.allowlist=...

########################
# TLS / Certificates (placeholders)
########################
# If you plan to enable TLS, mount certificates into the container (e.g., /certs)
# and enable the relevant policies. Example placeholders below:

# Enable TLS for Bolt with a named policy (uncomment and configure directories)
#dbms.ssl.policy.bolt.enabled=true
#dbms.ssl.policy.bolt.base_directory=/certs/bolt
#dbms.ssl.policy.bolt.private_key=private.key  # pragma: allowlist secret
#dbms.ssl.policy.bolt.public_certificate=public.crt
#dbms.ssl.policy.bolt.client_auth=NONE

# Enable TLS for HTTPS (uncomment if using HTTPS)
#dbms.ssl.policy.https.enabled=true
#dbms.ssl.policy.https.base_directory=/certs/https
#dbms.ssl.policy.https.private_key=private.key
#dbms.ssl.policy.https.public_certificate=public.crt

########################
# Directories & logging
########################
# Data and log directories (use defaults or adjust if mounting)
dbms.directories.data=/data
dbms.directories.logs=/logs
dbms.directories.import=/var/lib/neo4j/import
dbms.directories.plugins=/plugins
dbms.directories.certificates=/certs

# Logging configuration
dbms.logs.query.enabled=true
dbms.logs.query.parameter_logging_enabled=false
# Fine tune log rotation/retention via container log drivers or host-level rotation

########################
# Plugins & Procedures
########################
# If you need APOC or GDS, ensure the plugins directory is mounted and the procedures are allowed
# Example: place plugins in ./config/neo4j/plugins and mount into /plugins
# NOTE: Neo4j image may require specific plugin versions; verify compatibility with your Neo4j image tag.
# dbms.security.procedures.allowlist=apoc.coll.*
# dbms.security.procedures.unrestricted=apoc.*,gds.*

########################
# Metrics & Monitoring
########################
# Metrics reporter config (JMX, Prometheus, etc.) can be enabled here if needed.
# Example: enable Prometheus metrics (requires metrics plugin / exporter)
# metrics.enabled=true
# metrics.endpoint=/metrics

########################
# Misc / Performance knobs
########################
# Set page flush interval, checkpointing and batch size options here if you need to tune large imports.
# Example tuning for heavy import workloads:
# dbms.tx_log.rotation.retention_policy=100M size
# dbms.monitoring.collection.interval=5000ms

########################
# Bootstrap / Import Hints
########################
# Keep the import directory writable by the Neo4j process and mount host import data as needed.
# The SBIR ETL scripts expect data to be available under /var/lib/neo4j/import when using CSV imports.

########################
# Placeholder tips
########################
# Use environment interpolation in compose or your entrypoint to keep secrets out of this file:
#   - set NEO4J_AUTH via .env or CI secrets, or set NEO4J_USER / NEO4J_PASSWORD
# Example `.env` entries:
#   NEO4J_USER=neo4j
#   NEO4J_PASSWORD=change_me  # pragma: allowlist secret
#   NEO4J_server_memory_heap_max__size=1G
#
# If you need settings that vary by environment (dev/test/prod), keep this template under config/neo4j
# and overlay it or replace it using your deployment tooling.

# End of file

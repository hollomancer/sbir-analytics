# Dagster Cloud Multi-Location Deployment
#
# sbir-analytics-core: Lightweight ETL (serverless) - ingestion, enrichment, Neo4j
# sbir-analytics-ml: Heavy ML workloads (hybrid/EC2) - training, inference, embeddings
#
# Documentation: https://docs.dagster.io/dagster-cloud/deployment/hybrid

locations:
  # Core ETL - runs on Dagster Cloud Serverless (lightweight, fast)
  - location_name: sbir-analytics-core
    code_source:
      module_name: src.definitions_core
    build:
      directory: .
      python_version: "3.11"
    container_context:
      k8s:
        env_vars:
          # Skip heavy ML/fiscal assets in serverless
          - DAGSTER_LOAD_HEAVY_ASSETS=false

  # ML workloads - runs on your own compute (hybrid agent)
  - location_name: sbir-analytics-ml
    code_source:
      module_name: src.definitions_ml
    build:
      directory: .
      registry: ghcr.io/hollomancer/sbir-analytics-ml
    agent_queue: ml-queue  # Route to specific agent for ML workloads

# Dagster Cloud Serverless Deployment
#
# Core ETL runs on Dagster Cloud Serverless (lightweight, fast)
# ML jobs run on-demand via GitHub Actions (see .github/workflows/run-ml-jobs.yml)
#
# Documentation: docs/deployment/github-actions-ml.md

locations:
  # Core ETL - runs on Dagster Cloud Serverless (minimal, fast startup)
  - location_name: sbir-analytics-core
    code_source:
      module_name: src.definitions_minimal
    build:
      directory: .
      python_version: "3.11"
      base_requirements_txt: requirements.txt
    container_context:
      k8s:
        env_vars:
          # Skip heavy ML/fiscal assets in serverless
          - DAGSTER_LOAD_HEAVY_ASSETS=false
        server_k8s_config:
          container_config:
            resources:
              requests:
                cpu: "500m"
                memory: "1Gi"
              limits:
                cpu: "2000m"
                memory: "4Gi"
